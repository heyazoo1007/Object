## 10장

코드 중복, 상속, 상속의 문제점, 추상화

## DRY 원칙 (Do not repeat yourself)

코드 안에 중복코드를 넣으면 안된다

### 중복 코드인지 알아보는 법

하나의 요구사항에 대해 두 코드 이상을 함께 수정해야한다면 중복 코드이다

### 중복 코드의 문제점

1. 변경을 방해한다
2. 코드 수정에 불필요한 노력을 요구한다

### 중복코드 제거하는 법

1. 상속
2. 추상화
3. (합성)

### 상속

중복되는 코드를 부모 클래스에서 구현하고, 자식 클래스가 해당 코드를 재사용하는 구조

상속이 강력한 이유: 익숙한 개념을 이용해서 새로운 개념을 쉽고 빠르게 추가할 수 있다

### 문제 1: 강한 결합도

자식 클래스가 부모 클래스의 구현을 알고 있어야 하기 때문에 결합도가 증가한다

취약한 기반 클래스 문제가 발생한다

취약한 기반 클래스 문제: 상속 관계로 연결된 자식 클래스가 부모 클래스의 변경에 취약해지는 현상

경고1

부모와 자식 클래스는 강하게 결합된다. super호출을 제거할 수 있는 방법을 찾아 결합도를 제거하라

### 문제 2: 불필요한 인터페이스 상속

퍼블릭 인터페이스에 대한 고려 없이 단순히 코드 재사용을 목적으로 상속을 이용하면 문제가 발생한다

(Vector&Stack, Hashtable&Properties → 하위 클래스에서 상위 클래스 연산을 이용한 후 출력하면 오류가 발생한다??)

경고2

상속받은 부모 클래스의 메서드가 자식 클래스의 내부 구조에 대한 규칙을 깨뜨릴 수 있다

### 문제 3: 메서드 오버라이딩의 오작용

경고3

자식 클래스가 부모 크래스의 메서드를 오버라이딩할 경우 부모 클래스가 자신의 메서드를 사용하는 방법에 자식 클래스가 결합될 수 있다

### 문제 4: 부모 클래스와 자식 클래스의 동시 수정 문제

경고 4

클래스를 상속하면 결합도로 인해 부모,자식 클래스를 동시에 아예 바꾸지 않거나, 동시에 바꿔야 한다

### 결론: 상속을 하면 코드 재사용을 할 수 있지만, 캡슐화를 약화 시킨다 → `추상화`를 이용하자

### 정리: 코드 중복 → 상속(코드 재사용함으로써 코드 중복 해결) → 추상화(상속의 결합도 문제 해결)

### 추상화 하는 방법

1. 유사한 메서드에서 차이점을 메서드로 추출하라
2. 차이를 뺀 후 남은 공통 부분을 클래스의 상위 클래스로 올려라. 자식 클래스의 추상적인 메서드를 부모 클래스로 올리는 것이 재사용성과 응집도 측면에서 더 낫다

→ 부모,자식 클래스 모두 추상화에 의존함. 의존성 역전 원칙도 준수

### 결론

추상화를 찾아내고 상속 계층 안의 클래스들(부모,자식 클래스들)이 그 추상화에 의존하도록 코드를 리팩토링하라.

차이점을 메서드로 추출하고 공통적인 부분은 부모 클래스로 이동

그럼 부모 클래스가 추상화인건가???

### 차이에 의한 프로그래밍(programming by difference)

기존 코드와 다른 부분만을 추가함으로써 애플리케이션의 기능을 확장하는 방법

목표

중복 코드를 제거하고 코드를 재사용하는 것

재사용 가능한 코드: 심각한 버그가 존재하지 않는 코드

중복 코드는 추상화를 통해 하나의 부모 클래스에 옮기고, 연결은 상속을 통해서 하기

→ 코드 재사용 가능, 새로운 기능을 유연하게 추가 가능

단점이 존재

이는 합성으로 해결